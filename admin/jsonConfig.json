{
  "i18n": true,
  "type": "tabs",
  "items": {
    "login": {
      "type": "panel",
      "label": "SPOTIFY LOGIN",
      "items": {
        "_alive": {
          "type": "alive",
          "sm": 12
        },
        "_info": {
          "type": "staticText",
          "text": "Wichtig: Spotify nutzt OAuth. Du meldest dich bei Spotify an (im Browser), danach speichert der Adapter automatisch ein Refresh-Token.\n\nRedirect-URI Regeln: HTTPS ist Pflicht, außer bei Loopback (z.B. http://127.0.0.1:PORT). \"localhost\" ist nicht erlaubt.\n\nTipp (HTTPS + Self-Signed): Öffne die Callback-URL einmal manuell, um das Zertifikat im Browser zu akzeptieren (Warnung -> Erweitert -> Trotzdem öffnen).\n\nHinweis: Nach erfolgreichem Login bitte die Konfig-Seite einmal neu laden (F5), bevor du 'Speichern' klickst – sonst könnte ein altes (leeres) Token versehentlich überschrieben werden."
        },
        "clientId": {
          "type": "text",
          "label": "Spotify Client ID",
          "help": "Spotify Developer Dashboard → App → Client ID",
          "sm": 12,
          "md": 6
        },
        "clientSecret": {
          "type": "password",
          "label": "Spotify Client Secret (optional)",
          "help": "Optional. Der Adapter nutzt standardmäßig PKCE (ohne Secret). Wird verschlüsselt gespeichert.",
          "sm": 12,
          "md": 6
        },
        "redirectUri": {
          "type": "text",
          "label": "Redirect URI (Callback URL)",
          "help": "Muss exakt 1:1 im Spotify Developer Dashboard unter Redirect URIs eingetragen sein. Beispiel: https://192.168.10.102:8888/callback",
          "sm": 12,
          "md": 12
        },
        "callbackBindIp": {
          "type": "select",
          "label": "Callback-Server Bind-IP",
          "help": "Meist 0.0.0.0 (alle Interfaces). Bei Problemen (Firewall/Port belegt) anpassen.",
          "options": [
            {
              "label": "0.0.0.0",
              "value": "0.0.0.0"
            },
            {
              "label": "127.0.0.1 (nur lokal)",
              "value": "127.0.0.1"
            }
          ],
          "sm": 12,
          "md": 6
        },
        "generateSelfSignedCert": {
          "type": "checkbox",
          "label": "Self-Signed Zertifikat erzeugen (wenn Redirect URI https ist)",
          "help": "Wenn du https in der Redirect URI nutzt und kein Zertifikat hinterlegt hast, erzeugt der Adapter beim Start ein Self-Signed Zertifikat.",
          "sm": 12,
          "md": 6
        },
        "_divider1": {
          "type": "divider",
          "height": 2
        },
        "_connect": {
          "type": "sendTo",
          "label": "MIT SPOTIFY VERBINDEN",
          "command": "oauthConnect",
          "jsonData": "{\"clientId\":\"${data.clientId}\",\"clientSecret\":\"${data.clientSecret}\",\"redirectUri\":\"${data.redirectUri}\",\"callbackBindIp\":\"${data.callbackBindIp}\",\"generateSelfSignedCert\":${data.generateSelfSignedCert},\"_origin\":\"${data._origin}\",\"_originIp\":\"${data._originIp}\"}",
          "openUrl": true,
          "window": "spotify",
          "icon": "auth",
          "variant": "contained",
          "disabled": "!data.clientId || !data.redirectUri"
        },
        "_disconnect": {
          "type": "sendTo",
          "label": "VERBINDUNG TRENNEN (REFRESH-TOKEN LÖSCHEN)",
          "command": "oauthDisconnect",
          "jsonData": "{\"_origin\":\"${data._origin}\"}",
          "icon": "unpair",
          "variant": "outlined"
        },
        "_authUrl": {
          "type": "textSendTo",
          "label": "Login-URL (Fallback zum Kopieren)",
          "command": "oauthGetUrl",
          "jsonData": "{\"clientId\":\"${data.clientId}\",\"clientSecret\":\"${data.clientSecret}\",\"redirectUri\":\"${data.redirectUri}\"}",
          "copyToClipboard": true,
          "container": "text",
          "disabled": "!data.clientId || !data.redirectUri"
        },
        "refreshToken": {
          "type": "password",
          "label": "Refresh-Token",
          "help": "Wird nach erfolgreichem OAuth-Login automatisch gesetzt. Wird verschlüsselt gespeichert.",
          "sm": 12,
          "md": 12
        }
      }
    },
    "playback": {
      "type": "panel",
      "label": "PLAYBACK & GERÄTE",
      "items": {
        "defaultDeviceId": {
          "type": "text",
          "label": "Default Device ID (optional)",
          "help": "Optional: Device-ID, auf die Befehle standardmäßig gehen sollen (Spotify Connect).",
          "sm": 12,
          "md": 12
        },
        "pollInterval": {
          "type": "number",
          "label": "Polling Intervall (Sekunden)",
          "help": "Wie oft soll der aktuelle Playback-Status abgefragt werden.",
          "min": 2,
          "max": 60,
          "step": 1,
          "sm": 12,
          "md": 4
        },
        "autoRefreshDevicesOnStart": {
          "type": "checkbox",
          "label": "Devices beim Start aktualisieren",
          "sm": 12,
          "md": 4
        },
        "logApiErrors": {
          "type": "checkbox",
          "label": "API-Fehler detailliert loggen",
          "sm": 12,
          "md": 4
        }
      }
    }
  }
}
