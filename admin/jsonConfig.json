{
  "i18n": true,
  "type": "tabs",
  "items": {
    "_spotify": {
      "type": "panel",
      "label": "Spotify Login",
      "items": {
        "_alive": {
          "type": "alive",
          "sm": 12,
          "textAlive": "‚úÖ Instanz l√§uft (Adapter ist online)",
          "textNotAlive": "‚ö†Ô∏è Instanz ist offline ‚Äì bitte Instanz starten, damit der Login-Button funktioniert"
        },
        "_hint": {
          "type": "staticText",
          "sm": 12,
          "text": "<b>Wichtig:</b> Spotify nutzt OAuth. Du meldest dich bei Spotify an (im Browser), danach speichert der Adapter automatisch ein Refresh-Token.\n<br/><br/>\n<b>Spotify Security-Update:</b> Seit 27.11.2025 sind <i>unsichere</i> Redirect-URIs eingeschr√§nkt. F√ºr Redirects zu einem LAN-Host brauchst du i.d.R. <b>HTTPS</b>. HTTP geht nur f√ºr Loopback (z.B. <code>http://127.0.0.1:PORT</code>) ‚Äì das funktioniert nur, wenn du den Browser direkt auf dem ioBroker-Host nutzt.\n<br/><br/>\nüëâ Empfohlen: Nutze <b>https</b> in der Redirect-URI. Wenn du kein g√ºltiges Zertifikat hast, kann der Adapter ein <i>Self-Signed</i> Zertifikat erzeugen (Browser-Warnung muss einmal best√§tigt werden).<br/><br/><b>Hinweis:</b> Nach erfolgreichem Login bitte die Konfig-Seite einmal neu laden (F5), bevor du 'Speichern' klickst ‚Äì sonst k√∂nnte ein noch altes (leeres) Token versehentlich √ºberschrieben werden."
        },
        "clientId": {
          "type": "text",
          "label": "Spotify Client ID",
          "sm": 12,
          "md": 6,
          "help": "Spotify Developer Dashboard ‚Üí App ‚Üí Client ID"
        },
        "clientSecret": {
          "type": "password",
          "label": "Spotify Client Secret",
          "sm": 12,
          "md": 6,
          "help": "Spotify Developer Dashboard ‚Üí App ‚Üí Client Secret (wird verschl√ºsselt gespeichert)"
        },
        "redirectUri": {
          "type": "text",
          "label": "Redirect URI (Callback URL)",
          "sm": 12,
          "help": "Diese URL musst du 1:1 in Spotify Developer Dashboard ‚Üí App ‚Üí Edit Settings ‚Üí Redirect URIs eintragen. Beispiel: https://iobroker.lan:8888/callback"
        },
        "bind": {
          "type": "ip",
          "label": "Callback-Server Bind-IP",
          "sm": 12,
          "md": 6,
          "help": "Meist 0.0.0.0 (alle Interfaces). Bei Problemen (Port belegt/Netzwerk) anpassen."
        },
        "useSelfSignedCert": {
          "type": "checkbox",
          "label": "Self-Signed Zertifikat erzeugen (wenn Redirect URI https ist)",
          "sm": 12,
          "md": 6,
          "help": "Wenn du https in der Redirect URI nutzt und kein Zertifikat hinterlegt hast, erzeugt der Adapter beim Start ein Self-Signed Zertifikat."
        },
        "_connect": {
          "type": "sendTo",
          "label": "üîó Mit Spotify verbinden",
          "command": "oauthStart",
          "openUrl": true,
          "showProcess": true,
          "jsonData": "{\"origin\":\"${data._origin}\",\"originIp\":\"${data._originIp}\",\"clientId\":\"${data.clientId}\",\"clientSecret\":\"${data.clientSecret}\",\"redirectUri\":\"${data.redirectUri}\",\"bind\":\"${data.bind}\",\"useSelfSignedCert\":${data.useSelfSignedCert}}"
        },
        "_status": {
          "type": "textSendTo",
          "label": "Status",
          "sm": 12,
          "command": "oauthStatus",
          "jsonData": "{\"clientId\":\"${data.clientId}\",\"redirectUri\":\"${data.redirectUri}\"}",
          "alsoDependsOn": [
            "clientId",
            "redirectUri",
            "refreshToken"
          ]
        },
        "_disconnect": {
          "type": "sendTo",
          "label": "üßπ Verbindung trennen (Refresh-Token l√∂schen)",
          "command": "oauthDisconnect",
          "showProcess": true,
          "useNative": true,
          "jsonData": "{}"
        },
        "refreshToken": {
          "type": "password",
          "label": "Refresh Token (automatisch)",
          "sm": 12,
          "help": "Wird nach erfolgreichem Login automatisch gespeichert. Normalerweise musst du hier nichts eintragen.",
          "hidden": true
        }
      }
    },
    "_playback": {
      "type": "panel",
      "label": "Playback & Ger√§te",
      "items": {
        "_playHint": {
          "type": "staticText",
          "sm": 12,
          "text": "üí° Steuerung klappt nur, wenn mindestens ein Spotify Connect Ger√§t im Account aktiv ist (z.B. Spotify App am Handy/PC)."
        },
        "defaultDeviceId": {
          "type": "selectSendTo",
          "label": "Standard-Ger√§t (optional)",
          "sm": 12,
          "command": "listDevices",
          "manual": true,
          "noTranslation": true,
          "alsoDependsOn": [
            "refreshToken"
          ],
          "help": "Wenn gesetzt, werden Play/Pause/Next/etc. bevorzugt an dieses Device gesendet."
        },
        "pollInterval": {
          "type": "number",
          "min": 2,
          "max": 60,
          "label": "Polling-Intervall (Sekunden)",
          "sm": 12,
          "md": 6,
          "help": "Wie oft der Adapter den Wiedergabe-Status abruft."
        },
        "autoRefreshDevicesOnStart": {
          "type": "checkbox",
          "label": "Ger√§teliste beim Start aktualisieren",
          "sm": 12,
          "md": 6
        },
        "logApiErrors": {
          "type": "checkbox",
          "label": "Spotify API Errors im Log ausgeben",
          "sm": 12,
          "md": 6
        }
      }
    }
  }
}